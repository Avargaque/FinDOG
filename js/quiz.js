export const quizQuestions = [
	{
		id: 1,
		question: "Dlaczego chcesz psa? Wybierz jeden najważniejszy powód:",
		answers: [
			"By zyskać bliskiego przyjaciela",
			"By służył jako kompan dla moich dzieci",
			"By mieć towarzysza do spacerów i innych aktywności fizycznych",
			"Dla obrony domu i bliskich",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 2,
		question: "Czy posiadałeś wcześniej własnego psa na stałe?",
		answers: ["Nie", "Tak"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 3,
		question: "Gdzie będziecie mieszkać?",
		answers: ["W mieszkaniu", "W domu wolnostojącym"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 4,
		question: "Jak duże podwórko pies bedzie miał do dyspozycji?",
		answers: ["Brak podwórka", "Małe podwórko", "Duże podwórze, ogród"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 5,
		question:
			"Jak duży ruch ma miejsce przy podwórku, na którym przebywać będzie pies?",
		answers: ["Brak podwórka", "Niewielki ruch", "Duży ruch"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 6,
		question: "Gdzie pies będzie mieszkał i spał?",
		answers: [
			"Będzie mieszkał i spał w domu",
			"Będzie mieszkał i spał na zewnątrz",
			"Różnie",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 7,
		question:
			"Czy w twoim domu dominuje cisza i spokój, czy jest raczej głośno i ruchliwie? Weź pod uwagę domowników, inne zwierzęta, gości czy ogólny hałas.",
		answers: [
			"Jest cicho i spokojnie",
			"Jest głośno i ruchliwie",
			"Coś pomiędzy",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 8,
		question:
			"Jak bardzo istotne dla ciebie jest, aby pies był przyjazny dzieciom?",
		answers: ["Kluczowe", "Ważne", "Bez znaczenia"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 9,
		question:
			"Jak często planujesz wychodzić z psem na spacery i jak długie one będą?",
		answers: [
			"Wcale lub tylko w celu wypróżnienia",
			"Często, lecz krótkie",
			"Rzadko, lecz długie",
			"Często i długie",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 10,
		question:
			"Preferujesz psa mocno przywiązanego i nieodstępującego cię o krok czy bardziej niezależnego i potrafiącego się sobą zająć?",
		answers: ["Przywiązanego", "Niezależnego", "Pomiędzy"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 11,
		question:
			"Jak często pies będzie zostawał sam w domu?",
		answers: ["Nigdy lub prawie nigdy", "Czasami", "Codziennie na wiele godzin"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 12,
		question:
			"Czy otoczenie psa (miejsce zamieszkania, domownicy, styl życia) często będzie ulegać zmianie?",
		answers: ["Tak", "Nie", "Ciężko powiedzieć"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 13,
		question:
			"Czy posiadasz inne zwierzęta domowe, z którymi pies będzie miał bliską styczność?",
		answers: ["Tak", "Nie"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 14,
		question: "Wolisz, aby pies łatwo ufał nowym osobom?",
		answers: ["Tak", "Nie", "Bez znaczenia"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 15,
		question:
			"Czy chcesz by twój pies pełnił rolę strażnika ostrzegając przed obcymi?",
		answers: ["Tak", "Nie, wręcz przeciwnie", "Bez znaczenia"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 16,
		question: "Czy przeszkadza ci częste szczekanie psa?",
		answers: ["Tak", "Trochę", "Nie", "Wręcz przeciwnie!"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 17,
		question:
			"Czy przeszkadza ci kiedy pies bywa uparty i nie zawsze słucha swojego właściciela?",
		answers: ["Tak", "Trochę", "Nie"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 18,
		question: "Czy preferujesz bardzo aktywnego psa, wymagającego dużo ruchu?",
		answers: [
			"Tak, wolę psa aktywnego",
			"Nie, wolę psa mniej wymagającego ruchu",
			"Bez znaczenia",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 19,
		question:
			"Czy preferujesz psa, który potrzebuje wielu różnych stymulujących zajęć?",
		answers: [
			"Tak, chcę psa, z którym można spędzać czas na różne sposoby",
			"Nie, wolę takiego, który sam się sobą zajmie",
			"Bez znaczenia",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 20,
		question: "Czy preferujesz psa, który uwielbia bawić się z tobą bez końca?",
		answers: [
			"Tak",
			"Nie, wolę takiego, który nie domaga się zabawy",
			"Bez znaczenia",
		],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 21,
		question:
			"Czy preferujesz psa, który kocha trening i poznawanie nowych sztuczek?",
		answers: ["Tak", "Nie, wręcz przeciwnie", "Bez znaczenia"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 22,
		question: "Czy zależy ci na tym, by pies był długowieczny?",
		answers: ["Tak, to ważne", "Nie jest to dla mnie istotne"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 23,
		question: "Czy przeszkadza ci konieczność częstego czesania psa?",
		answers: ["Tak", "Nie"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 24,
		question:
			"Czy przeszkadza ci duża ilość sierści zostawianej przez psa?",
		answers: ["Tak", "Nie"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 25,
		question: "Czy przeszkadza ci ślinienie się psa?",
		answers: ["Tak", "Nie"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 26,
		question:
			"Czy zależy ci na tym, aby dobrana rasa była jak najłatwiej dostępna do pozyskania w naszym kraju?",
		answers: ["Tak", "Nie jest to dla mnie istotne"],
		inputType: "radio",
		userAnswerRadio: "",
	},
	{
		id: 27,
		question: "Jaki rozmiar psa preferujesz? (Możesz wybrać kilka odpowiedzi)",
		answers: ["Mały", "Średni", "Duży"],
		inputType: "checkbox",
		userAnswersCheckbox: [],
	},
	{
		id: 28,
		question:
			"Jaką długość sierści psa preferujesz? (Możesz wybrać kilka odpowiedzi)",
		answers: ["Krótka", "Średnia", "Długa"],
		inputType: "checkbox",
		userAnswersCheckbox: [],
	},
];

let currentQuestionIndex = 0;
let barWidth = document.querySelector(".bar-width");
const nextQuestionBtns = document.querySelectorAll(".next-question-icon");
const previousQuestionBtns = document.querySelectorAll(
	".previous-question-icon"
);

// loads quiz question
function loadQuestion(questionIndex) {
	const answersForm = document.querySelector(".answers");
	const currentQuestion = quizQuestions[questionIndex];

	// sets progress bar width
	let width = (currentQuestionIndex + 1) * (100 / quizQuestions.length);
	barWidth.style.width = `${width}%`;

	// removes arrow in first and last questions
	if (questionIndex === 0) {
		previousQuestionBtns.forEach((btn) => {
			btn.classList.add("invisible");
		});
	} else {
		previousQuestionBtns.forEach((btn) => {
			btn.classList.remove("invisible");
		});
	}
	if (questionIndex === quizQuestions.length - 1) {
		nextQuestionBtns.forEach((btn) => {
			btn.classList.add("invisible");
		});
	} else {
		nextQuestionBtns.forEach((btn) => {
			btn.classList.remove("invisible");
		});
	}

	// updates question number
	document.querySelector(".current-question-number").textContent =
		currentQuestion.id;
	document.querySelector(".num-of-questions").textContent =
		quizQuestions.length;

	// updates question
	document.querySelector(".current-question-text").textContent =
		currentQuestion.question;

	// deletes previous answers
	answersForm.innerHTML = "";

	// adds new answers
	currentQuestion.answers.forEach((answer) => {
		const label = document.createElement("label");
		label.classList.add("answers__label");

		let input = document.createElement("input");

		if (currentQuestion.inputType === "radio") {
			input.type = "radio";
			input.name = "radio-answer";
			input.value = answer;

			// restores previously selected answer
			if (currentQuestion.userAnswerRadio === answer) {
				input.checked = true;
			}
		}

		if (currentQuestion.inputType === "checkbox") {
			input.type = "checkbox";
			input.name = "checkbox-answer";
			input.value = answer;

			// restores previously selected answer
			if (currentQuestion.userAnswersCheckbox.includes(answer)) {
				input.checked = true;
			}
		}

		const span = document.createElement("span");
		span.textContent = answer;

		label.append(input);
		label.append(span);
		answersForm.append(label);
	});
}

// loads next quiz question
function nextQuestion() {
	// checks checkbox answers
	if ("userAnswersCheckbox" in quizQuestions[currentQuestionIndex]) {
		const checkedCheckboxes = document.querySelectorAll(
			`input[name="checkbox-answer"]:checked`
		);
		const priorityChecked = document.querySelector(
			`input[name="radio-priority"]:checked`
		);

		if (checkedCheckboxes.length === 0) {
			alert("Proszę zaznaczyć odpowiedzi przed pójściem dalej");
			return;
		}
	}

	// checks radio answers
	if ("userAnswerRadio" in quizQuestions[currentQuestionIndex]) {
		const checkedRadio = document.querySelector(
			`input[name="radio-answer"]:checked`
		);

		if (checkedRadio === null) {
			alert("Proszę zaznaczyć odpowiedź przed pójściem dalej");
			return;
		}
	}

	// saves answers
	if (currentQuestionIndex >= quizQuestions.length - 1) {
		saveAnswers();
		loadQuestion(currentQuestionIndex);
	} else {
		saveAnswers();
		currentQuestionIndex++;
		loadQuestion(currentQuestionIndex);
	}
}

// loads previous quiz question
function previousQuestion() {
	saveAnswers();
	currentQuestionIndex--;
	if (currentQuestionIndex < 0) {
		currentQuestionIndex++;
	}
	loadQuestion(currentQuestionIndex);
}

// saves answers for current question
function saveAnswers() {
	// saves radio answer to quizQuestions array
	if ("userAnswersCheckbox" in quizQuestions[currentQuestionIndex]) {
		const checkboxAnswers = document.querySelectorAll(
			`input[name="checkbox-answer"]:checked`
		);
		if (checkboxAnswers.length > 0) {
			quizQuestions[currentQuestionIndex].userAnswersCheckbox = [];
			checkboxAnswers.forEach((input) =>
				quizQuestions[currentQuestionIndex].userAnswersCheckbox.push(
					input.nextElementSibling.textContent.trim()
				)
			);
		}
	}

	// saves checkbox answers to quizQuestions array
	if ("userAnswerRadio" in quizQuestions[currentQuestionIndex]) {
		const radioAnswer = document.querySelector(
			`input[name="radio-answer"]:checked`
		);
		if (radioAnswer !== null) {
			quizQuestions[currentQuestionIndex].userAnswerRadio =
				radioAnswer.nextElementSibling.textContent.trim();
		}
	}

	console.log(quizQuestions[currentQuestionIndex]);
}

nextQuestionBtns.forEach((btn) => {
	btn.addEventListener("click", nextQuestion);
});
previousQuestionBtns.forEach((btn) => {
	btn.addEventListener("click", previousQuestion);
});

document.addEventListener("DOMContentLoaded", function () {
	loadQuestion(currentQuestionIndex);
});
